<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç»Ÿè®¡ - æç®€è®°è´¦æœ¬</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Flatpickr (ç°ä»£åŒ–æ—¥æœŸé€‰æ‹©å™¨) -->
    <link href="{{ url_for('static', filename='css/lib/flatpickr.min.css') }}" rel="stylesheet">
    <script src="{{ url_for('static', filename='js/flatpickr.min.js') }}"></script>
    <script src="{{ url_for('static', filename='js/flatpickr.zh.js') }}"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#3b82f6',
                        secondary: '#64748b',
                        success: '#10b981',
                        warning: '#f59e0b',
                        danger: '#ef4444',
                        info: '#06b6d4',
                        light: '#f9fafb',
                        dark: '#1e293b',
                        'primary-light': '#dbeafe',
                        'secondary-light': '#f1f5f9',
                        'border-color': '#e2e8f0'
                    },
                    fontFamily: {
                        sans: ['Inter', 'Microsoft YaHei', 'sans-serif']
                    },
                    fontSize: {
                        'xs': ['0.75rem', { lineHeight: '1rem' }],
                        'sm': ['0.875rem', { lineHeight: '1.25rem' }],
                        'base': ['1rem', { lineHeight: '1.5rem' }],
                        'lg': ['1.125rem', { lineHeight: '1.75rem' }],
                        'xl': ['1.25rem', { lineHeight: '1.75rem' }],
                        '2xl': ['1.5rem', { lineHeight: '2rem' }]
                    },
                    boxShadow: {
                        'card': '0 2px 8px 0 rgba(0, 0, 0, 0.08)',
                        'card-hover': '0 4px 16px 0 rgba(0, 0, 0, 0.12)',
                        'modal': '0 8px 32px 0 rgba(0, 0, 0, 0.16)'
                    }
                }
            }
        }
    </script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .card {
                @apply bg-white rounded-xl shadow-card transition-all duration-300;
            }
            .card:hover {
                @apply shadow-card-hover transform -translate-y-1;
            }
            .btn {
                @apply px-3 py-2 rounded-lg font-medium text-sm transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2;
            }
            .btn-primary {
                @apply bg-primary text-white hover:bg-primary/90 focus:ring-primary;
            }
            .btn-secondary {
                @apply bg-secondary text-white hover:bg-secondary/90 focus:ring-secondary;
            }
            .btn-success {
                @apply bg-success text-white hover:bg-success/90 focus:ring-success;
            }
            .btn-danger {
                @apply bg-danger text-white hover:bg-danger/90 focus:ring-danger;
            }
            .btn-outline {
                @apply border border-border-color text-secondary hover:bg-secondary-light focus:ring-primary;
            }
            /* ç§»åŠ¨ç«¯å‹å¥½æŒ‰é’®æ ·å¼ - æµ…è‰²èƒŒæ™¯é…å½©è‰²æ–‡å­— */
            .btn-edit {
                @apply px-3 py-2 rounded-lg font-medium text-sm transition-all duration-200 bg-amber-100 text-amber-600 hover:bg-amber-200 active:bg-amber-300 focus:outline-none focus:ring-2 focus:ring-amber-400 flex items-center justify-center gap-1;
            }
            .btn-use {
                @apply px-3 py-2 rounded-lg font-medium text-sm transition-all duration-200 bg-emerald-100 text-emerald-600 hover:bg-emerald-200 active:bg-emerald-300 focus:outline-none focus:ring-2 focus:ring-emerald-400 flex items-center justify-center gap-1;
            }
            .btn-delete {
                @apply px-3 py-2 rounded-lg font-medium text-sm transition-all duration-200 bg-rose-100 text-rose-600 hover:bg-rose-200 active:bg-rose-300 focus:outline-none focus:ring-2 focus:ring-rose-400 flex items-center justify-center gap-1;
            }
            .btn-action {
                @apply px-3 py-2 rounded-lg font-medium text-sm transition-all duration-200 bg-blue-100 text-blue-600 hover:bg-blue-200 active:bg-blue-300 focus:outline-none focus:ring-2 focus:ring-blue-400 flex items-center justify-center gap-1;
            }
            .btn-neutral {
                @apply px-3 py-2 rounded-lg font-medium text-sm transition-all duration-200 bg-gray-100 text-gray-600 hover:bg-gray-200 active:bg-gray-300 focus:outline-none focus:ring-2 focus:ring-gray-400 flex items-center justify-center gap-1;
            }
            .input {
                @apply w-full px-4 py-2 border border-border-color rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent;
            }
            .select {
                @apply w-full px-4 py-2 border border-border-color rounded-lg focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent;
            }
            .nav-item {
                @apply flex flex-col items-center justify-center gap-1 px-4 py-3 transition-all duration-200 relative;
            }
            .nav-item.active {
                @apply text-primary;
            }
            .nav-item.active::after {
                @apply content-[''] absolute bottom-0 left-1/2 transform -translate-x-1/2 w-1/2 h-0.5 bg-primary rounded-full;
            }
            .nav-item:hover {
                @apply text-primary;
            }
            .nav-icon {
                @apply text-xl;
            }
            .nav-label {
                @apply text-xs font-medium;
            }
            .table-hover {
                @apply hover:bg-gray-50 transition-colors;
            }
        }
    </style>
    <style>
        /* å…¨å±€æ ·å¼ */
        body {
            font-family: 'Inter', 'Microsoft YaHei', sans-serif;
        }
        /* è‡ªå®šä¹‰æ»šåŠ¨æ¡ */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1;
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8;
        }
        
        /* æ—¥æœŸè¾“å…¥æ¡†æ ·å¼ - ä½¿ç”¨å†…è”SVGèƒŒæ™¯å›¾æ ‡ */
        .date-input-wrapper input {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2394a3b8' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Crect x='3' y='4' width='18' height='18' rx='2' ry='2'%3E%3C/rect%3E%3Cline x1='16' y1='2' x2='16' y2='6'%3E%3C/line%3E%3Cline x1='8' y1='2' x2='8' y2='6'%3E%3C/line%3E%3Cline x1='3' y1='10' x2='21' y2='10'%3E%3C/line%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 12px center;
            background-size: 16px 16px;
            padding-right: 40px;
            cursor: pointer;
            /* éšè—æµè§ˆå™¨é»˜è®¤æ—¥æœŸå›¾æ ‡ */
            -webkit-appearance: none;
            -moz-appearance: none;
            appearance: none;
        }
        /* é’ˆå¯¹Webkitæµè§ˆå™¨çš„æ—¥æœŸè¾“å…¥æ¡† */
        .date-input-wrapper input::-webkit-calendar-picker-indicator {
            opacity: 0;
            display: none;
            -webkit-appearance: none;
        }
        /* é’ˆå¯¹IE/Edge */
        .date-input-wrapper input::-ms-clear,
        .date-input-wrapper input::-ms-reveal {
            display: none;
        }
        
        /* ç§»åŠ¨ç«¯æ—¥æœŸé€‰æ‹©å™¨é€‚é… */
        @media (max-width: 767px) {
            .flatpickr-calendar {
                width: 90vw !important;
                max-width: 320px !important;
                left: 50% !important;
                transform: translateX(-50%) !important;
                position: fixed !important;
                top: 50% !important;
                transform: translate(-50%, -50%) !important;
                z-index: 9999 !important;
            }
            .flatpickr-calendar.open {
                display: block !important;
            }
            .flatpickr-days {
                width: 100% !important;
            }
            .dayContainer {
                width: 100% !important;
                min-width: 100% !important;
                max-width: 100% !important;
            }
            .flatpickr-day {
                max-width: none !important;
                height: 40px !important;
                line-height: 40px !important;
            }
        }
    </style>
</head>
<body class="bg-light font-sans">
    <!-- ä¸»å†…å®¹åŒº -->
    <main class="flex-grow container mx-auto px-4 py-6 pb-20">
        <div class="space-y-6">
            <div class="flex justify-between items-center">
                <h1 class="text-2xl font-bold text-secondary">ç»Ÿè®¡</h1>
            </div>

        <!-- æŸ¥è¯¢è¡¨å• -->
        <div class="card mb-6 p-6">
            <div class="flex flex-col gap-4">
                <!-- ç»Ÿè®¡ç±»å‹ -->
                <div class="flex flex-col md:flex-row md:items-center gap-2">
                    <label for="subType" class="text-base font-medium text-gray-700 md:w-24">ç»Ÿè®¡ç±»å‹</label>
                    <select id="subType" class="select flex-1 text-base">
                        <option value="">è¯·é€‰æ‹©ç»Ÿè®¡ç±»å‹</option>
                        {% for type in sub_types %}
                            <option value="{{ type.name }}">{{ type.name }}</option>
                        {% endfor %}
                    </select>
                </div>
                <!-- æ—¶é—´èŒƒå›´ -->
                <div class="flex flex-col md:flex-row md:items-center gap-2">
                    <label class="text-base font-medium text-gray-700 md:w-24">æ—¶é—´èŒƒå›´</label>
                    <div class="flex flex-col md:flex-row gap-4 flex-1">
                        <div class="flex-1 date-input-wrapper">
                            <input type="text" id="startDate" placeholder="å¼€å§‹æ—¥æœŸ" class="input w-full text-base">
                        </div>
                        <div class="flex-1 date-input-wrapper">
                            <input type="text" id="endDate" placeholder="ç»“æŸæ—¥æœŸ" class="input w-full text-base">
                        </div>
                    </div>
                </div>
                <!-- æŸ¥è¯¢æŒ‰é’® -->
                <button class="btn-action text-base" onclick="queryPrice()">
                    <i class="fa fa-search"></i>æŸ¥è¯¢
                </button>
            </div>
        </div>

        <!-- ä»·æ ¼ç»Ÿè®¡ï¼ˆæŸ¥è¯¢åæ˜¾ç¤ºï¼‰ -->
        <div id="priceStat" class="mb-6" style="display: none;"></div>

        <!-- ä»·æ ¼åˆ—è¡¨è¡¨æ ¼ - æ¡Œé¢ç«¯ -->
        <div class="card overflow-x-auto hidden md:block">
            <table class="w-full border-collapse" id="priceTable">
                <thead>
                    <tr class="bg-secondary-light">
                        <th class="px-4 py-3 text-left text-sm font-medium text-secondary border-b border-border-color whitespace-nowrap">æ¶ˆè´¹å†…å®¹</th>
                        <th class="px-4 py-3 text-left text-sm font-medium text-secondary border-b border-border-color whitespace-nowrap">ç»Ÿè®¡ç±»å‹</th>
                        <th class="px-4 py-3 text-left text-sm font-medium text-secondary border-b border-border-color whitespace-nowrap">æ€»ä»·</th>
                        <th class="px-4 py-3 text-left text-sm font-medium text-secondary border-b border-border-color whitespace-nowrap">æœ€å°å•ä½å•ä»·</th>
                        <th class="px-4 py-3 text-left text-sm font-medium text-secondary border-b border-border-color whitespace-nowrap">è´­ä¹°æ—¥æœŸ</th>
                        <th class="px-4 py-3 text-left text-sm font-medium text-secondary border-b border-border-color whitespace-nowrap">è´­ä¹°æ¸ é“</th>
                    </tr>
                </thead>
                <tbody id="priceTableBody">
                    <tr>
                        <td colspan="6" class="py-16 text-center text-gray-500 text-lg">
                            è¯·é€‰æ‹©ç»Ÿè®¡ç±»å‹å¹¶ç‚¹å‡»æŸ¥è¯¢ ğŸ“Š
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- ä»·æ ¼åˆ—è¡¨å¡ç‰‡ - ç§»åŠ¨ç«¯ -->
        <div class="space-y-4 md:hidden" id="mobilePriceList">
            <div class="card p-10 text-center text-gray-500">
                <i class="fa fa-search text-3xl mb-3 text-gray-400"></i>
                <p>è¯·é€‰æ‹©ç»Ÿè®¡ç±»å‹å¹¶ç‚¹å‡»æŸ¥è¯¢</p>
            </div>
        </div>
        </div>
    </main>

    <!-- Toast è½»æç¤º -->
    <div id="toast" class="fixed top-20 left-1/2 transform -translate-x-1/2 z-50 hidden">
        <div class="bg-gray-800 text-white px-6 py-3 rounded-lg shadow-lg flex items-center gap-3 min-w-[200px] max-w-[80vw]">
            <i class="fas fa-info-circle" id="toastIcon"></i>
            <span id="toastMessage" class="text-sm">æç¤ºä¿¡æ¯</span>
        </div>
    </div>

    <!-- åº•éƒ¨å¯¼èˆªæ  -->
    <footer class="fixed bottom-0 left-0 right-0 bg-white shadow-md z-40">
        <div class="flex justify-around items-center h-16">
            <a href="/" class="nav-item">
                <i class="fas fa-home nav-icon"></i>
                <span class="nav-label">é¦–é¡µ</span>
            </a>
            <a href="/list" class="nav-item">
                <i class="fas fa-plus-circle nav-icon"></i>
                <span class="nav-label">è®°è´¦</span>
            </a>
            <a href="/pending" class="nav-item">
                <i class="fas fa-truck nav-icon"></i>
                <span class="nav-label">å¾…æ”¶è´§</span>
                {% if pending_count > 0 %}
                <span class="absolute -top-1 -right-1 bg-danger text-white text-xs w-5 h-5 rounded-full flex items-center justify-center">
                    {{ pending_count }}
                </span>
                {% endif %}
            </a>
            <a href="/price" class="nav-item active">
                <i class="fas fa-chart-bar nav-icon"></i>
                <span class="nav-label">ç»Ÿè®¡</span>
            </a>
            <a href="/manage" class="nav-item">
                <i class="fas fa-cog nav-icon"></i>
                <span class="nav-label">è®¾ç½®</span>
            </a>
        </div>
    </footer>

    <!-- è„šæœ¬ï¼šä»·æ ¼æŸ¥è¯¢é€»è¾‘ -->
    <script>
        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', function() {
            // åˆå§‹åŒ–æ—¥æœŸé€‰æ‹©å™¨
            if (typeof flatpickr !== 'undefined') {
                try {
                    flatpickr('#startDate', {
                        locale: 'zh',
                        dateFormat: 'Y-m-d',
                        maxDate: 'today',
                        disableMobile: true,
                        position: 'auto',
                        appendTo: document.body,
                        clickOpens: true,
                        allowInput: false
                    });
                    
                    flatpickr('#endDate', {
                        locale: 'zh',
                        dateFormat: 'Y-m-d',
                        maxDate: 'today',
                        disableMobile: true,
                        position: 'auto',
                        appendTo: document.body,
                        clickOpens: true,
                        allowInput: false
                    });
                } catch (error) {
                    console.error('åˆå§‹åŒ–æ—¥æœŸé€‰æ‹©å™¨å¤±è´¥:', error);
                }
            }
            
            // è®¾ç½®é»˜è®¤æ—¶é—´èŒƒå›´ä¸ºè¿‘20å¤©
            setDefaultDateRange();
        });
        
        // è®¾ç½®é»˜è®¤æ—¶é—´èŒƒå›´ä¸ºè¿‘20å¤©
        function setDefaultDateRange() {
            const endDate = new Date();
            const startDate = new Date();
            startDate.setDate(startDate.getDate() - 19); // è¿‘20å¤©
            
            // æ ¼å¼åŒ–æ—¥æœŸä¸º YYYY-MM-DD
            const formatDate = (date) => {
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                return `${year}-${month}-${day}`;
            };
            
            document.getElementById('startDate').value = formatDate(startDate);
            document.getElementById('endDate').value = formatDate(endDate);
        }

        // æ ¼å¼åŒ–æ—¥æœŸæ˜¾ç¤º
        function formatDateDisplay(dateStr) {
            if (!dateStr) return '';
            try {
                // å°è¯•è§£æå¸¦æ—¶é—´çš„æ ¼å¼
                const dt = new Date(dateStr);
                const year = dt.getFullYear();
                const month = String(dt.getMonth() + 1).padStart(2, '0');
                const day = String(dt.getDate()).padStart(2, '0');
                const hours = String(dt.getHours()).padStart(2, '0');
                const minutes = String(dt.getMinutes()).padStart(2, '0');
                const seconds = String(dt.getSeconds()).padStart(2, '0');
                return `${year}å¹´${month}æœˆ${day}æ—¥ ${hours}:${minutes}:${seconds}`;
            } catch (error) {
                return dateStr;
            }
        }

        // æ˜¾ç¤º Toast è½»æç¤º
        function showToast(message, type = 'info') {
            const toast = document.getElementById('toast');
            const msg = document.getElementById('toastMessage');
            const icon = document.getElementById('toastIcon');
            
            msg.textContent = message;
            
            // è®¾ç½®å›¾æ ‡å’Œé¢œè‰²
            if (type === 'error') {
                icon.className = 'fas fa-times-circle text-red-400';
            } else if (type === 'success') {
                icon.className = 'fas fa-check-circle text-green-400';
            } else {
                icon.className = 'fas fa-info-circle text-blue-400';
            }
            
            toast.classList.remove('hidden');
            
            // 3ç§’åè‡ªåŠ¨éšè—
            setTimeout(() => {
                toast.classList.add('hidden');
            }, 3000);
        }

        // æŸ¥è¯¢ä»·æ ¼
        function queryPrice() {
            const subType = document.getElementById('subType').value;
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            
            if (!subType) {
                showToast('è¯·é€‰æ‹©è¦æŸ¥è¯¢çš„ç»Ÿè®¡ç±»å‹ï¼');
                return;
            }

            // æ„å»ºAPIè¯·æ±‚URL
            let url = `/api/consumption/type/${encodeURIComponent(subType)}`;
            if (startDate && endDate) {
                url += `?startDate=${startDate}&endDate=${endDate}`;
            }

            // è°ƒç”¨ä»·æ ¼æŸ¥è¯¢æ¥å£
            fetch(url)
            .then(response => response.json())
            .then(data => {
                const tableBody = document.getElementById('priceTableBody');
                const mobileList = document.getElementById('mobilePriceList');
                const priceStat = document.getElementById('priceStat');
                
                // æ¸…ç©ºåŸæœ‰å†…å®¹
                tableBody.innerHTML = '';
                mobileList.innerHTML = '';
                
                if (data.success && data.data.length > 0) {
                    // æ¸²æŸ“ä»·æ ¼åˆ—è¡¨ï¼ˆæ¡Œé¢ç«¯ï¼‰
                    data.data.forEach(item => {
                        const tr = document.createElement('tr');
                        tr.className = 'table-hover';
                        tr.innerHTML = `
                            <td class="px-4 py-3 text-sm border-b whitespace-nowrap">${item.content}</td>
                            <td class="px-4 py-3 text-sm border-b whitespace-nowrap">${item.sub_type}</td>
                            <td class="px-4 py-3 text-sm font-medium text-secondary border-b whitespace-nowrap">Â¥${item.total_price}</td>
                            <td class="px-4 py-3 text-sm border-b whitespace-nowrap">Â¥${item.min_unit_price || '0.00'}</td>
                            <td class="px-4 py-3 text-sm border-b whitespace-nowrap">${formatDateDisplay(item.create_time)}</td>
                            <td class="px-4 py-3 text-sm border-b whitespace-nowrap">${item.channel}</td>
                        `;
                        tableBody.appendChild(tr);
                    });
                    
                    // æ¸²æŸ“ä»·æ ¼åˆ—è¡¨ï¼ˆç§»åŠ¨ç«¯ï¼‰
                    data.data.forEach(item => {
                        const card = document.createElement('div');
                        card.className = 'card p-4';
                        card.innerHTML = `
                            <div class="flex justify-between items-start mb-2">
                                <h3 class="font-medium text-secondary flex-1 pr-2">${item.content}</h3>
                                <span class="font-medium text-primary whitespace-nowrap">Â¥${item.min_unit_price || '0.00'}</span>
                            </div>
                            <div class="flex flex-wrap gap-x-4 gap-y-1 text-sm text-gray-500">
                                <span>æ€»ä»·: Â¥${item.total_price}</span>
                                <span>${formatDateDisplay(item.create_time).split(' ')[0]}</span>
                                <span>${item.channel}</span>
                            </div>
                        `;
                        mobileList.appendChild(card);
                    });

                    // è®¡ç®—ä»·æ ¼ç»Ÿè®¡ï¼ˆå‡ä»·ã€æœ€ä½ä»·ã€æœ€é«˜ä»·ï¼‰
                    const prices = data.data.map(item => {
                        const price = parseFloat(item.min_unit_price);
                        return isNaN(price) ? 0 : price;
                    });
                    let avgPrice = '0.00';
                    let minPrice = '0.00';
                    let maxPrice = '0.00';
                    
                    if (prices.length > 0) {
                        const validPrices = prices.filter(price => price > 0);
                        if (validPrices.length > 0) {
                            avgPrice = (validPrices.reduce((a, b) => a + b, 0) / validPrices.length).toFixed(2);
                            minPrice = Math.min(...validPrices).toFixed(2);
                            maxPrice = Math.max(...validPrices).toFixed(2);
                        }
                    }

                    // æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
                    priceStat.style.display = 'block';
                    priceStat.innerHTML = `
                        <div class="card p-4">
                            <div class="flex items-center justify-between mb-3">
                                <div class="flex items-center gap-2">
                                    <i class="fa fa-bar-chart text-primary text-lg"></i>
                                    <h3 class="text-lg font-semibold text-secondary">ç»Ÿè®¡ï¼ˆ${subType}ï¼‰</h3>
                                </div>
                                <span class="text-sm text-gray-500">${data.count}æ¡è®°å½•</span>
                            </div>
                            <!-- ç§»åŠ¨ç«¯ï¼šæ¨ªå‘æ»šåŠ¨å±•ç¤º -->
                            <div class="flex md:grid md:grid-cols-3 gap-2 overflow-x-auto pb-1 -mx-1 px-1 md:mx-0 md:px-0 md:pb-0">
                                <div class="bg-secondary-light/50 p-2 rounded-lg flex-shrink-0 min-w-[100px] md:min-w-0 md:p-3">
                                    <div class="text-xs text-gray-500 mb-0.5 md:mb-1">å‡ä»·</div>
                                    <div class="text-base font-medium text-primary md:text-lg">Â¥${avgPrice}</div>
                                </div>
                                <div class="bg-secondary-light/50 p-2 rounded-lg flex-shrink-0 min-w-[100px] md:min-w-0 md:p-3">
                                    <div class="text-xs text-gray-500 mb-0.5 md:mb-1">æœ€ä½ä»·</div>
                                    <div class="text-base font-medium text-success md:text-lg">Â¥${minPrice}</div>
                                </div>
                                <div class="bg-secondary-light/50 p-2 rounded-lg flex-shrink-0 min-w-[100px] md:min-w-0 md:p-3">
                                    <div class="text-xs text-gray-500 mb-0.5 md:mb-1">æœ€é«˜ä»·</div>
                                    <div class="text-base font-medium text-danger md:text-lg">Â¥${maxPrice}</div>
                                </div>
                            </div>
                        </div>
                    `;
                } else {
                    // ç©ºæ•°æ®æç¤ºï¼ˆæ¡Œé¢ç«¯ï¼‰
                    tableBody.innerHTML = `<tr><td colspan="6" class="py-16 text-center text-gray-500 text-lg">æš‚æ— ${subType}çš„ä»·æ ¼æ•°æ®</td></tr>`;

                    // ç©ºæ•°æ®æç¤ºï¼ˆç§»åŠ¨ç«¯ï¼‰
                    mobileList.innerHTML = `
                        <div class="card p-10 text-center text-gray-500">
                            <i class="fa fa-inbox text-3xl mb-3 text-gray-400"></i>
                            <p>æš‚æ— ${subType}çš„ä»·æ ¼æ•°æ®</p>
                        </div>
                    `;
                    
                    priceStat.style.display = 'none';
                }
            })
            .catch(error => {
                console.error('ä»·æ ¼æŸ¥è¯¢å¤±è´¥ï¼š', error);
                showToast('ç½‘ç»œé”™è¯¯ï¼Œè¯·é‡è¯•ï¼', 'error');
            });
        }
    </script>
</body>
</html>